3.2.3.9 DDoS承受能力
定义：链网节点被DDoS攻击期间可承受的最大数据包接收速率。
计算方法：
①DDoS承受能力DRC(DDoS remaining capacity)
DRC =RBC/P_s 
其中：RBC表示节点剩余带宽承受能力，P_s表示节点遭受DDoS攻击期间接收的数据包大小平均值
测量方法：当前节点在测量时间内通过tcpdump抓取从网络接口接收的所有数据包，其中数据包大小的平均值作为P_s，计算出DDoS承受能力。
3.2.3.10 DDoS交易广播转发抵抗能力
定义：评估网络对恶意交易转发行为的识别和阻止能力。
计算方法：
恶意交易拒绝比MTR(malicious transaction rejection ratio)，指在系统识别出恶意交易的数量M_n中系统能够拒绝转发的恶意交易数量R_n的占比。
MTR=□(R_n/M_n )
测量方法：当前节点每30s通过tcpdump抓取从网络接口接收的所有数据包并计算以下指标，当节点同一源账户地址的交易验证失败率>交易吞吐率的最大值，节点交易丢弃率>交易吞吐率的最大值，节点交易池挂起率>交易吞吐率的最大值，其中两者出现则判定恶意交易事件发生。将交易验证失败率>交易吞吐率的最大值的同一发起账户、节点交易池中gas使用量<交易花费平均值的交易发起账户标记为恶意账户，将属于恶意账户的交易数量统计为M_n与拒绝转发的恶意交易数量R_n。
当节点叉链交易重复性>0则触发双花交易预警，统计重复账户在分叉区块中的所有交易信息（转账金额、NONCE、账户余额、交易哈希），若出现两笔交易的NONCE值一致或账户余额不足支付两笔交易则判定双花交易事件发生。当节点识别链重组日志时，若分叉链上重复账户的交易没有全部在最长链上则判定双花交易事件发生。
3.2.3.11 DDoS攻击交易转发抵抗能力
定义：模拟攻击强度X的DDoS攻击时，区块链网络中节点对外部交易的接收与转发能力。
计算方法：
①DDoS交易转发抵抗能力（DDoS Transaction Resistance Capability）
TRC=□((∑_(i=1)^M▒R_i/N)/M)
其中，M表示链网节点的数目，Ri 表示各节点接收的交易数量，N表示总交易数量
测量方法：在攻击条件下，模拟向网络发送N笔交易，各节点记录自身成功接收到的交易数量，并将结果反馈至中心服务器。中心服务器计算各节点接收交易数的平均值。
3.2.3.12 DDoS攻击交易可识别性
定义：网络在识别和报告DDoS攻击事件的能力。
计算方法：
攻击响应度AR(attack responsiveness)，计算系统识别DDoS攻击事件至攻击发起的时间差，衡量系统响应攻击事件的速度。
AR=t_a-t_0
其中：t_a表示系统识别出DDoS攻击的时刻，t_0表示攻击流量短时间内超过阈值的时刻。
测量方法：当前节点每30s通过tcpdump抓取从网络接口接收的所有数据包并计算以下指标，当节点数据包碎片比>0.25%，即受到碎片包泛洪；当节点接收的TCP SYN请求数据包数量超出节点SYN请求承受能力，即受到SYN泛洪；当节点收到与发送的TCP数据包比率高达N，则受到TCP泛洪；当节点收到与发送的UDP数据包比率高达N且5秒内没有给定源与目标的TCP连接，即受到UDP泛洪；当节点ICMP请求回复比>1.5，即受到ICMP泛洪；节点交易丢弃率>交易吞吐率的最大值，即受到交易泛洪。当节点受到以上任意类型泛洪则判定遭受DDoS攻击，记录时刻t_a。
当前节点接收数据包速率超出DDoS承受能力、节点剩余连接能力为0、节点连接失败率高达N，其中任意事件发生则判定遭受DDoS攻击，记录时刻t_a。
3.2.3.13 DDoS攻击交易溯源能力
定义：衡量网络在攻击发生时追踪攻击源的能力。
计算方法：
溯源速率TS(traceability speed)，指从确认为攻击事件始，至追踪到该攻击事件的发起源所消耗的时间。
TS=t_n-t_a
其中：t_n表示系统追踪到攻击源的时刻，t_a表示识别出DDoS攻击的时刻
测量方法：在节点上部署监控脚本，当监控到某个账户在某个时间段内，发起的交易中，溢出交易比例大于80%，就标记该账户为攻击源，并记录时间t_n。
3.2.3.14 DDoS溯源准确度
定义：衡量网络在攻击发生时追踪攻击源的能力。
计算方法：
溯源准确度TA(traceability accuracy)，指系统识别攻击源的准确度。
TA=□(A_n/T_n )
其中：A_n表示系统准确识别的攻击源数量，T_n表示所有攻击源数量 
    测量方法：根据识别系统标记的攻击源为A_n，T_n 为已知真实攻击源集合。
3.2.3.15 DDoS攻击流量传播范围
定义：衡量DDoS攻击在区块链网络中传播扩散的程度，即攻击影响覆盖的节点比例。
计算方法：
DDoS攻击流量传播范围（Spread Ratio）
SPR=□(A_n/N)
其中：A_n表示收到DDoS攻击的节点数量，N表示网络中的总节点数量
测量方法：统计网络中出现DDoS攻击的节点数目记录为A_n,N为网络中的总节点数量。
3.2.3.16叉链交易重复性
定义：链网节点出现分叉时，在侧链与主链的暂时分叉区块中都存在交易的发起账户数量。
计算方法：
叉链交易重复性FTD (fork-chain transaction duplication)
FTD =Txcount (F)∩Txcount (M)
其中：Txcount (F)表示当前分叉链在分叉区块之后的交易发起账户集合，Txcount (M) 表示当前主链在分叉区块之后的交易发起账户集合 
测量方法：当前节点通过分叉日志识别链分叉事件的发生并记录分叉区块哈希，然后通过web3.js监听块生成事件和getblockbyhash()保留分叉区块之后所有的区块信息。当节点出现链重组日志，则根据丢弃的区块哈希识别主链区块与侧链区块，两者的交易发起账户交集为FTD。
3.2.3.17恶意交易可识别性
定义：链网在识别和报告恶意交易攻击事件的能力。
计算方法：
①识别覆盖率DC(detection coverage ratio)，衡量系统准确识别恶意交易的比例。
DC=□(A_n/T_n )
其中：A_n表示系统识别出的真实攻击事件数量，T_n表示总计发起攻击事件的数量
②攻击误报率AFP(attack false positive ratio)，衡量系统错误地标记正常交易为恶意交易的概率。
AFP=□(P_n/C_n )
其中：P_n表示系统错误识别为攻击事件的数量，C_n表示正常事件的数量
③攻击漏报率AFN(attack false negative ratio)，衡量系统未能识别真实安全事件的概率。
AFN=□(N_n/T_n )
其中：N_n表示系统未能识别的真实攻击事件数量，B_n表示总计发起攻击事件的数量
④攻击响应度AR(attack responsiveness)，计算系统识别恶意交易事件至攻击发起的时间差，衡量系统响应攻击事件的速度。
AR=t_a-t_0
其中：t_a表示系统识别出恶意交易的时刻，t_0表示攻击发起的时刻
测量方法：将恶意交易检测机制识别出的恶意交易数量与双花交易数量之和统计为A_n，判定恶意交易与双花交易事件发生的时刻为t_a。
3.2.3.18恶意交易轨迹追踪能力
定义：链网在恶意交易攻击发生时追踪攻击源的溯源速率和溯源准确度。
计算方法：
①溯源速率TS(traceability speed)，指从确认为攻击事件始，至追踪到该攻击事件的发起源所消耗的时间。
TS=t_a-t_0
其中：t_a表示系统追踪到攻击源的时刻，t_0表示确认为攻击事件的时刻
②溯源准确度TA(traceability accuracy)，指系统识别攻击源的准确度。
TA=□(A_n/T_n )
其中：A_n表示系统准确识别的攻击源数量，T_n表示所有攻击源数量
测量方法：当节点判定恶意交易和双花交易事件发生后，将恶意账户与双花交易发起账户统计为攻击源并记录A_n。
3.2.3.19恶意交易攻击流量传播范围
定义：链网中恶意交易攻击流量在总流量中的占比。
计算方法：
攻击流量比AT(attack traffic ratio)，衡量攻击流量的传播程度
AT=□(A_t/(A_t+C_t ))
其中：A_t表示网络的攻击流量，C_t表示网络中的正常流量
测量方法：恶意交易事件发生后，将源地址为攻击源IP地址的数据包标记为攻击流量A_t。
3.2.3.20抢跑成功率(Front-running success Rate)
定义：对识别为恶意/可疑目标发起的抢跑尝试中，实际成功插队并达成预期效果的比例。
数据需求：
①识别出的全部抢跑事件集合A。
②对每个事件的执行状态判定(success / failed )。
计算公式：
FSR=□(S/A)
其中：S = |{status = success}|。
测量步骤:
①在测量窗口内运行抢跑检测器，形成事件列表，并持久化执行状态（可由区块回放或 eth_getTransactionReceipt 推断）；
②过滤掉测试流量或非恶意策略标签的事件；
③对剩余事件统计总体数量 A 以及成功数量 S；
④计算成功率，保留小数并附带样本基数。
注意事项：
①针对多腿（三明治）事件，任意必需腿失败则视为整体失败。
②若事件缺失执行状态，需补齐回执或在结果中标记未决。
3.2.3.21热点合约抢跑率(Hot contract Front-running Rate)
定义：识别出的抢跑尝试中，目标合约属于热点名单的比例。
数据需求：
①事件集合A。
②每个事件是否命中热点标签(is hot_contract)。
计算公式：
HCR=□(H/A)
其中：H = |{is_hot_contract = 1}|。
测量步骤:
①更新热点合约列表（静态名单 + 动态高频 + 标签框架），确保在检测阶段即可打标；
②统计测量窗口内热点事件数量 H，并记录总样本数 A。
③输出比例及热点名单版本号，方便追溯。
注意事项：
①热点列表应包含时间戳或版本信息，防止指标跨版本不可比；
②对多合约交互的事件，建议按最先调用的合约判断。
3.2.3.22抢跑平均gas溢价(Average Gas premium)
定义：抢跑交易相对其目标受害交易所付出的平均 gas 单价溢价。
数据需求：
①事件集合A。
②每个事件的抢跑交易与受害交易的有效gas单价（支持EIP-1559字段effectiveGasPrice/maxFeePerGas ）。
计算公式：
AGP=1/A ∑_(i=1)^A▒( gas_f^((i))-gas_v^((i)))
测量步骤:
①采集 mempool 视图，记录受害/抢跑交易的首次见到时间和 gas 参数。
②结合区块执行信息补充  effectiveGasPrice ，优先使用实际成交价格。
③对缺失数据的事件剔除或标记后再计算平均值，并同时输出有效样本计数。
注意事项：
①单价需统一单位（Wei 或 Gwei），避免混淆。
②若使用 maxFeePerGas ，需考虑 base fee 影响，推荐采用 effectiveGasPrice 或 priority fee 。
3.2.3.23抢跑交易识别率(Front-running Detection coverage)
定义：链网在测量时间内真实发生的抢跑事件中，被系统识别为抢跑的比例。
数据需求：
①真实抢跑事件全集（真值集）规模 N，来自模拟回放、人工标注或可信检测器。
②识别引擎判定为抢跑且能与真值关联的事件数量 Tt。
计算公式：
FDC=□(T_t/N)
测量步骤：
①建立真值集（Ground Truth），要求包含受害交易哈希、抢跑交易哈希、模式标签等字段，并标记时间窗口。
②在同一时间窗口运行识别系统，获取检测结果。
③根据 (victim_tx, frontrunner_tx)或事件标识做匹配，计算命中数量 Tt。
④输出覆盖率，并附加漏报清单用于复盘。
注意事项：
①真值集需记录生成或标注来源，避免与线上流量混淆。
②若存在多个可接受的抢跑交易（如同一受害交易被多个机器人抢跑），应允许以集合匹配。
